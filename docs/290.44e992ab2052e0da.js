"use strict";(self.webpackChunkFreshCartEcommerce=self.webpackChunkFreshCartEcommerce||[]).push([[290],{5290:(v,m,a)=>{a.r(m),a.d(m,{CartComponent:()=>p});var d=a(6814),C=a(1120),t=a(4769),h=a(6286);function u(r,b){if(1&r){const e=t.EpF();t.TgZ(0,"div",10)(1,"div",11),t._UZ(2,"img",12),t.qZA(),t.TgZ(3,"div",13)(4,"div")(5,"h3",14),t._uU(6),t.qZA(),t.TgZ(7,"p",6),t._uU(8),t.ALo(9,"currency"),t.qZA(),t.TgZ(10,"button",15,16),t.NdJ("click",function(){const o=t.CHM(e).$implicit,_=t.MAs(11),l=t.oxw(2);return t.KtG(l.removeItem(o.product._id,_))}),t.TgZ(12,"i",17),t._uU(13," Remove"),t.qZA()()(),t.TgZ(14,"div",18)(15,"button",19,20),t.NdJ("click",function(){const o=t.CHM(e).$implicit,_=t.MAs(16),l=t.MAs(21),g=t.oxw(2);return t.KtG(g.changeCount(o.product._id,o.count+1,_,l))}),t._uU(17,"+"),t.qZA(),t.TgZ(18,"span",21),t._uU(19),t.qZA(),t.TgZ(20,"button",22,23),t.NdJ("click",function(){const o=t.CHM(e).$implicit,_=t.MAs(16),l=t.MAs(21),g=t.oxw(2);return t.KtG(g.changeCount(o.product._id,o.count-1,_,l))}),t._uU(22,"-"),t.qZA()()()()}if(2&r){const e=b.$implicit;t.xp6(2),t.Q6J("src",e.product.imageCover,t.LSH)("alt",e.product.title),t.xp6(4),t.Oqu(e.product.title),t.xp6(2),t.Oqu(t.xi3(9,5,e.price,"EGP ")),t.xp6(11),t.Oqu(e.count)}}const x=function(r){return["/payment",r]};function n(r,b){if(1&r){const e=t.EpF();t.TgZ(0,"section",2)(1,"div",3)(2,"h1",4),t._uU(3,"Shop Cart"),t.qZA(),t.TgZ(4,"button",5),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.clearCartData())}),t._uU(5,"Clear Cart"),t.qZA()(),t.TgZ(6,"p",6),t._uU(7),t.ALo(8,"currency"),t.qZA(),t.YNc(9,u,23,8,"div",7),t.TgZ(10,"button",8),t._uU(11,"Online Payment "),t._UZ(12,"img",9),t.qZA()()}if(2&r){const e=t.oxw();t.xp6(7),t.hij("Total Price: ",t.xi3(8,3,e.cartData.totalCartPrice," EGP "),""),t.xp6(2),t.Q6J("ngForOf",e.cartData.products),t.xp6(1),t.Q6J("routerLink",t.VKq(6,x,e.cartData._id))}}function c(r,b){1&r&&(t.TgZ(0,"h2",24),t._uU(1,"Your Cart is Empty..."),t.qZA())}let p=(()=>{class r{constructor(e,s){this._CartService=e,this._Renderer2=s,this.cartData=null}ngOnInit(){this._CartService.getUserCart().subscribe({next:e=>{this.cartData=e.data}})}removeItem(e,s){this._Renderer2.setAttribute(s,"disabled","true"),this._CartService.removeFromCart(e).subscribe({next:i=>{this._CartService.getCount(),this.cartData=i.data,this._Renderer2.removeAttribute(s,"disabled")},error:i=>{this._Renderer2.removeAttribute(s,"disabled")}})}changeCount(e,s,i,o){s>=1?(this._Renderer2.setAttribute(i,"disabled","true"),this._Renderer2.setAttribute(o,"disabled","true"),this._CartService.updateCartCount(e,s).subscribe({next:_=>{this._CartService.getCount(),this.cartData=_.data,this._Renderer2.removeAttribute(i,"disabled"),this._Renderer2.removeAttribute(o,"disabled"),0===s&&this.clearCartData()},error:_=>{this._Renderer2.removeAttribute(i,"disabled"),this._Renderer2.removeAttribute(o,"disabled"),console.log(_)}})):(this.removeItem(e,i),this._Renderer2.setAttribute(o,"disabled","true"))}clearCartData(){this._CartService.clearFromCart().subscribe({next:e=>{"success"===e.message&&(this.cartData=null,this._CartService.cartItemNumber.next(0))},error:e=>{console.log(e)}})}static#t=this.\u0275fac=function(s){return new(s||r)(t.Y36(h.N),t.Y36(t.Qsj))};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-cart"]],standalone:!0,features:[t.jDz],decls:3,vars:2,consts:[["class","w-75 mx-auto rounded shadow p-4 bg-main-light marginY",4,"ngIf","ngIfElse"],["msg",""],[1,"w-75","mx-auto","rounded","shadow","p-4","bg-main-light","marginY"],[1,"d-flex","justify-content-between","hstack"],[1,"fw-bold","text-main"],[1,"btn","btn-outline-danger",3,"click"],[1,"text-main"],["class","row border-bottom py-3",4,"ngFor","ngForOf"],[1,"main-btn",3,"routerLink"],["src","./assets/images/visa-1.svg","alt",""],[1,"row","border-bottom","py-3"],[1,"col-md-3"],[1,"w-100",3,"src","alt"],[1,"col-md-9","hstack","justify-content-between"],[1,"h5"],[1,"btn","p-0","m-0",3,"click"],["rmBtn",""],[1,"fas","fa-trash","rmBtn"],[1,"btn-group"],[1,"btn","btn-success",3,"click"],["updateBtn1",""],[1,"p-2","fs-5"],[1,"btn","btn-danger",3,"click"],["updateBtn2",""],[1,"text-center","marginY"]],template:function(s,i){if(1&s&&(t.YNc(0,n,13,8,"section",0),t.YNc(1,c,2,0,"ng-template",null,1,t.W1O)),2&s){const o=t.MAs(2);t.Q6J("ngIf",i.cartData)("ngIfElse",o)}},dependencies:[d.ez,d.sg,d.O5,d.H9,C.rH]})}return r})()},6286:(v,m,a)=>{a.d(m,{N:()=>h});var d=a(5619),C=a(4769),t=a(9862);let h=(()=>{class u{constructor(n){this._HttpClient=n,this.baseUrl="https://ecommerce.routemisr.com/api/v1/",this.cartItemNumber=new d.X(0)}addToCart(n){return this._HttpClient.post(this.baseUrl+"cart",{productId:n})}getUserCart(){return this._HttpClient.get(this.baseUrl+"cart")}removeFromCart(n){return this._HttpClient.delete(this.baseUrl+`cart/${n}`)}updateCartCount(n,c){return this._HttpClient.put(this.baseUrl+`cart/${n}`,{count:c})}clearFromCart(){return this._HttpClient.delete(this.baseUrl+"cart")}getAllOrders(){return this._HttpClient.get(this.baseUrl+"orders")}checkOut(n,c){return this._HttpClient.post(this.baseUrl+`orders/checkout-session/${n}?url=https://mohamed-mosad1.github.io/ecommerce-website`,{shippingAddress:c})}getCount(){this.getUserCart().subscribe({next:n=>{const c=n.data.products;let p=0;for(let r=0;r<c.length;r++)p+=c[r].count;this.cartItemNumber.next(p)}})}static#t=this.\u0275fac=function(c){return new(c||u)(C.LFG(t.eN))};static#e=this.\u0275prov=C.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})}return u})()}}]);